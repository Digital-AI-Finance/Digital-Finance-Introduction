<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 1.1: What Is Money | Introduction to Digital Finance</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --mlpurple: #3333B2;
            --mlblue: #0066CC;
            --quiz-accent: #8b5cf6;
            --quiz-light: #ede9fe;
            --correct: #22c55e;
            --correct-bg: #dcfce7;
            --incorrect: #ef4444;
            --incorrect-bg: #fee2e2;
            --bg: #f6f8fa;
            --card-bg: #ffffff;
            --text: #24292e;
            --text-secondary: #586069;
            --border: #e1e4e8;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.4;
            min-height: 100vh;
        }

        .nav {
            background: linear-gradient(135deg, var(--mlpurple), var(--mlblue));
            color: white;
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .nav-title { font-weight: 600; font-size: 14px; }
        .nav-links { display: flex; gap: 16px; }
        .nav-links a { color: white; text-decoration: none; font-size: 12px; opacity: 0.9; }
        .nav-links a:hover { opacity: 1; }

        .quiz-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 12px;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 0 4px;
        }
        .quiz-title { font-size: 16px; font-weight: 600; color: var(--mlpurple); }
        .quiz-stats {
            display: flex;
            gap: 12px;
            font-size: 12px;
        }
        .stat-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
        }
        .stat-progress { background: var(--quiz-light); color: var(--quiz-accent); }
        .stat-score { background: var(--correct-bg); color: var(--correct); }

        .progress-bar-container {
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin-bottom: 12px;
        }
        .progress-bar {
            height: 100%;
            background: var(--quiz-accent);
            border-radius: 2px;
            transition: width 0.3s;
        }

        /* Three-column layout */
        .questions-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .question-card {
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 12px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            min-height: 280px;
        }

        .question-card.answered { opacity: 0.7; }

        .question-card.correct-card {
            border: 2px solid var(--correct);
            background: linear-gradient(to bottom, var(--correct-bg), var(--card-bg));
        }

        .question-card.incorrect-card {
            border: 2px solid var(--incorrect);
            background: linear-gradient(to bottom, var(--incorrect-bg), var(--card-bg));
        }

        .q-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .q-number {
            background: var(--quiz-light);
            color: var(--quiz-accent);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        .q-status { font-size: 14px; }

        .q-text {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 10px;
            line-height: 1.4;
            flex-grow: 0;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex-grow: 1;
        }

        .option-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            min-height: 44px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--card-bg);
            cursor: pointer;
            transition: all 0.15s;
            text-align: left;
            font-size: 12px;
        }

        .option-btn:hover:not(.disabled) {
            border-color: var(--quiz-accent);
            background: var(--quiz-light);
        }

        .option-btn.correct {
            border-color: var(--correct);
            background: var(--correct-bg);
        }

        .option-btn.incorrect {
            border-color: var(--incorrect);
            background: var(--incorrect-bg);
        }

        .option-btn.disabled { cursor: default; }

        .option-letter {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 10px;
            flex-shrink: 0;
        }

        .option-btn.correct .option-letter {
            background: var(--correct);
            color: white;
        }

        .option-btn.incorrect .option-letter {
            background: var(--incorrect);
            color: white;
        }

        .option-text { flex: 1; }

        .feedback {
            margin-top: 8px;
            padding: 8px;
            border-radius: 6px;
            font-size: 10px;
            line-height: 1.4;
            display: none;
        }

        .feedback.show { display: block; }
        .feedback.correct { background: var(--correct-bg); color: #166534; }
        .feedback.incorrect { background: var(--incorrect-bg); color: #991b1b; }

        /* Results */
        .results-card {
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 32px;
            text-align: center;
            max-width: 500px;
            margin: 40px auto;
            display: none;
        }
        .results-card.show { display: block; }
        .results-icon { font-size: 48px; margin-bottom: 8px; }
        .results-score { font-size: 36px; font-weight: 700; color: var(--quiz-accent); }
        .results-label { font-size: 14px; color: var(--text-secondary); margin-bottom: 16px; }
        .results-grade {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .grade-a { background: #dcfce7; color: #166534; }
        .grade-b { background: #dbeafe; color: #1e40af; }
        .grade-c { background: #fef3c7; color: #92400e; }
        .grade-d { background: #fed7aa; color: #9a3412; }
        .grade-f { background: #fee2e2; color: #991b1b; }

        .results-buttons { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            text-decoration: none;
        }
        .btn-primary { background: var(--quiz-accent); color: white; }
        .btn-primary:hover { background: #7c3aed; }
        .btn-secondary { background: var(--card-bg); color: var(--text); border: 1px solid var(--border); }

        /* Next button container */
        .next-btn-container {
            display: flex;
            justify-content: center;
            margin-top: 16px;
        }
        .btn-next {
            padding: 10px 32px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            background: var(--quiz-accent);
            color: white;
            transition: all 0.2s;
            display: none;
        }
        .btn-next:hover { background: #7c3aed; transform: scale(1.02); }
        .btn-next.show { display: inline-block; }
        .btn-next:disabled { opacity: 0.5; cursor: not-allowed; }

        @media (max-width: 900px) {
            .questions-row { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 600px) {
            .questions-row { grid-template-columns: 1fr; }
            .question-card { min-height: auto; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-title">Quiz 1.1: What Is Money</div>
        <div class="nav-links">
            <a href="../index.html">Dashboard</a>
            
            <a href="https://github.com/Digital-AI-Finance/Digital-Finance-Introduction" target="_blank">GitHub</a>
        </div>
    </nav>

    <main class="quiz-container">
        <div class="quiz-header">
            <div class="quiz-title">Quiz 1.1: What Is Money</div>
            <div class="quiz-stats">
                <span class="stat-badge stat-progress" id="progressBadge">0/20</span>
                <span class="stat-badge stat-score" id="scoreBadge">Score: 0</span>
            </div>
        </div>

        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>

        <div class="questions-row" id="questionsRow"></div>

        <div class="next-btn-container">
            <button class="btn-next" id="nextBtn" onclick="loadNextQuestions()">Next</button>
        </div>

        <div class="results-card" id="resultsCard">
            <div class="results-icon" id="resultsIcon"></div>
            <div class="results-score" id="resultsScore"></div>
            <div class="results-label">Correct Answers</div>
            <div class="results-grade" id="resultsGrade"></div>
            <div class="results-buttons">
                <button class="btn btn-primary" onclick="restartQuiz()">Try Again</button>
                <a href="../index.html" class="btn btn-secondary">Dashboard</a>
            </div>
        </div>
    </main>

    <script>
        const quizData = {
            questions: [
                {
                                "id": 1,
                                "question": "Which of the following is NOT one of the three fundamental functions of money?",
                                "options": {
                                                "A": "Medium of exchange",
                                                "B": "Unit of account",
                                                "C": "Source of government revenue",
                                                "D": "Store of value"
                                },
                                "correct": "C",
                                "explanation": "The three fundamental functions of money are: (1) medium of exchange (facilitating trade), (2) unit of account (measuring value), and (3) store of value (preserving purchasing power over time). While governments may collect taxes using money, generating revenue is not a core function of money itself.",
                                "difficulty": "easy"
                },
                {
                                "id": 2,
                                "question": "What is the primary purpose of a ledger in a financial system?",
                                "options": {
                                                "A": "To generate interest on deposits",
                                                "B": "To record transactions and track balances",
                                                "C": "To prevent inflation",
                                                "D": "To calculate exchange rates"
                                },
                                "correct": "B",
                                "explanation": "A ledger is fundamentally a record-keeping system that tracks who owns what and records all transfers between parties. Every financial system, from ancient clay tablets to modern blockchains, is built on ledgers that maintain the integrity of ownership and transaction history.",
                                "difficulty": "easy"
                },
                {
                                "id": 3,
                                "question": "What is the double-spending problem?",
                                "options": {
                                                "A": "When someone accidentally pays for the same item twice",
                                                "B": "When the same digital money is spent multiple times because digital information can be copied",
                                                "C": "When a bank charges fees twice for the same transaction",
                                                "D": "When two people try to spend money at exactly the same time"
                                },
                                "correct": "B",
                                "explanation": "The double-spending problem is the fundamental challenge of digital finance: unlike physical cash, digital information can be copied infinitely at zero cost. Without proper validation, someone could send the same digital money to multiple recipients, effectively spending it multiple times. This is THE central problem that blockchain technology was designed to solve.",
                                "difficulty": "easy"
                },
                {
                                "id": 4,
                                "question": "Why does physical money (like cash) automatically prevent double-spending?",
                                "options": {
                                                "A": "Because governments track every cash transaction",
                                                "B": "Because cash can only be used once per day",
                                                "C": "Because physical objects cannot be in two places at once - giving the bill to someone means you no longer have it",
                                                "D": "Because cash transactions require witnesses"
                                },
                                "correct": "C",
                                "explanation": "Physical money is self-proving and follows the laws of physics. When you give someone a $100 bill, you physically no longer possess it - you cannot give the same bill to another person. Physical transfer automatically prevents double-spending because matter cannot be duplicated. This property makes physical money trustworthy without needing any validation system.",
                                "difficulty": "easy"
                },
                {
                                "id": 5,
                                "question": "How do banks solve the double-spending problem in digital finance?",
                                "options": {
                                                "A": "By limiting the number of transactions per day",
                                                "B": "By maintaining a centralized ledger and validating every transaction against available balances before execution",
                                                "C": "By requiring physical signatures for all transactions",
                                                "D": "By converting all digital money back to physical cash"
                                },
                                "correct": "B",
                                "explanation": "Banks act as trusted intermediaries that maintain the single authoritative ledger. Before executing any transaction, they validate that the sender has sufficient balance. This centralized validation prevents double-spending because only the bank's ledger matters - all transactions must pass through the bank's validation system, which checks balances and processes transactions sequentially.",
                                "difficulty": "easy"
                },
                {
                                "id": 6,
                                "question": "What is a trusted intermediary in the context of financial systems?",
                                "options": {
                                                "A": "A government agency that prints money",
                                                "B": "A central authority (like a bank) that validates and records transactions, solving double-spending by maintaining the authoritative ledger",
                                                "C": "A lawyer who witnesses financial contracts",
                                                "D": "An insurance company that protects against fraud"
                                },
                                "correct": "B",
                                "explanation": "A trusted intermediary is a central authority that both parties trust to validate and record transactions accurately. In traditional finance, banks serve this role - they maintain the single source of truth (the ledger) and ensure that no one can double-spend by checking balances before allowing transfers. All parties must trust this intermediary to act honestly and maintain accurate records.",
                                "difficulty": "easy"
                },
                {
                                "id": 7,
                                "question": "In a centralized banking system, how are transactions validated before execution?",
                                "options": {
                                                "A": "By checking if the sender has sufficient balance to cover the transaction amount plus fees",
                                                "B": "By requiring approval from government regulators",
                                                "C": "By waiting 24 hours to see if the sender changes their mind",
                                                "D": "By matching fingerprints to account records"
                                },
                                "correct": "A",
                                "explanation": "Banks validate transactions by checking the sender's account balance against the total cost of the transaction (amount + fees). This balance check is the critical step that prevents double-spending. The transaction only executes if sufficient funds are available, and the balance is updated atomically - meaning it completes fully or not at all, preventing partial or duplicate transfers.",
                                "difficulty": "medium"
                },
                {
                                "id": 8,
                                "question": "Which of the following is NOT a cost of centralized trust in traditional banking?",
                                "options": {
                                                "A": "Transaction fees of 1-5% or more",
                                                "B": "Transfer delays of 3-5 business days for international transactions",
                                                "C": "Guaranteed protection against all forms of theft",
                                                "D": "Geographic restrictions and exclusion of 1.4 billion unbanked adults"
                                },
                                "correct": "C",
                                "explanation": "While banks provide some security measures, they do NOT guarantee protection against all theft. The actual costs of centralized trust include: fees (1-5%), delays (days for international transfers), access restrictions (1.4 billion unbanked globally), censorship risk (accounts can be frozen), counterparty risk (banks can fail), and privacy concerns (transaction surveillance). Banks can be hacked, accounts can be drained, and deposit insurance has limits.",
                                "difficulty": "medium"
                },
                {
                                "id": 9,
                                "question": "What happens during a bank run scenario?",
                                "options": {
                                                "A": "The bank increases interest rates to attract more deposits",
                                                "B": "Many customers simultaneously try to withdraw their deposits, but the bank lacks sufficient reserves because it has lent most deposits out",
                                                "C": "The bank moves to a new physical location",
                                                "D": "The bank converts all digital money to cryptocurrency"
                                },
                                "correct": "B",
                                "explanation": "A bank run occurs when many customers simultaneously attempt to withdraw their deposits, typically due to fears about the bank's solvency. Because of fractional reserve banking, banks only keep a small fraction (typically 10%) of deposits as reserves and lend the rest out. When too many customers demand withdrawals at once, the bank literally runs out of cash despite customers having balances on record. This demonstrates counterparty risk - the bank may not be able to honor its obligations.",
                                "difficulty": "medium"
                },
                {
                                "id": 10,
                                "question": "What is fractional reserve banking?",
                                "options": {
                                                "A": "A system where banks keep only a fraction (e.g., 10%) of deposits as reserves and lend out the rest",
                                                "B": "A system where customers can only withdraw fractions of their balance",
                                                "C": "A system where interest rates are calculated as fractions",
                                                "D": "A system where multiple banks share the same reserves"
                                },
                                "correct": "A",
                                "explanation": "Fractional reserve banking is the practice where banks keep only a small fraction of deposits as reserves (cash on hand) and lend out the remainder to earn interest. For example, with a 10% reserve ratio, a $1000 deposit results in $100 kept in reserves and $900 lent out. While this enables economic growth, it creates vulnerability during bank runs and means that not all depositors can withdraw simultaneously - introducing counterparty risk.",
                                "difficulty": "medium"
                },
                {
                                "id": 11,
                                "question": "What is counterparty risk in banking?",
                                "options": {
                                                "A": "The risk that your password might be stolen",
                                                "B": "The risk that the bank (your counterparty) might fail and be unable to return your deposits",
                                                "C": "The risk that transaction fees might increase",
                                                "D": "The risk that you might lose your debit card"
                                },
                                "correct": "B",
                                "explanation": "Counterparty risk is the risk that the other party in a transaction might not fulfill their obligations. When you deposit money in a bank, you're trusting that the bank will return your funds on demand. However, banks can fail (as seen in the 2008 financial crisis), face liquidity crises, or become insolvent. While deposit insurance provides some protection, it typically has limits, and not all countries offer robust insurance. This is a fundamental risk of having a centralized trusted intermediary.",
                                "difficulty": "medium"
                },
                {
                                "id": 12,
                                "question": "What is censorship risk in the context of banking?",
                                "options": {
                                                "A": "The risk that your emails to the bank might be intercepted",
                                                "B": "The risk that banks or governments can freeze accounts, block transactions, or refuse service to certain individuals",
                                                "C": "The risk that banks might not advertise their services",
                                                "D": "The risk that bank statements might contain errors"
                                },
                                "correct": "B",
                                "explanation": "Censorship risk refers to the ability of banks (or governments) to control, restrict, or prevent financial transactions. Banks can freeze accounts, block transfers, or refuse service based on various criteria. Governments can compel banks to seize funds or prevent transactions to certain parties or countries. While this power can be used legitimately (e.g., fighting money laundering), it also means users don't have complete control over their own money - the centralized intermediary has ultimate authority.",
                                "difficulty": "medium"
                },
                {
                                "id": 13,
                                "question": "What is a major geographic limitation of traditional finance?",
                                "options": {
                                                "A": "Banks can only operate in English-speaking countries",
                                                "B": "International transfers take 3-5 business days, cost 3-5% in fees, and approximately 1.4 billion adults worldwide lack access to banking services",
                                                "C": "ATMs don't work across state borders",
                                                "D": "Credit cards expire when traveling internationally"
                                },
                                "correct": "B",
                                "explanation": "Traditional finance has significant geographic barriers: international transfers are slow (3-5 days) and expensive (3-5% fees plus FX markups), many countries have limited banking infrastructure, and approximately 1.4 billion adults globally remain unbanked due to lack of documentation, minimum balance requirements, or simply living in areas without bank branches. Blockchain technology aims to address this by being global by default, operating 24/7, and not requiring traditional identification.",
                                "difficulty": "medium"
                },
                {
                                "id": 14,
                                "question": "According to the World Bank Global Findex data referenced in the notebook, approximately how many adults worldwide are unbanked?",
                                "options": {
                                                "A": "140 million",
                                                "B": "400 million",
                                                "C": "1.4 billion",
                                                "D": "4 billion"
                                },
                                "correct": "C",
                                "explanation": "Approximately 1.4 billion adults worldwide lack access to formal banking services. This massive exclusion happens due to various barriers: lack of government ID, inability to meet minimum balance requirements, living in remote areas without bank branches, and failing credit checks. This statistic highlights one of the major motivations for blockchain technology - creating a permissionless financial system that anyone can access regardless of location or documentation.",
                                "difficulty": "medium"
                },
                {
                                "id": 15,
                                "question": "What does it mean for a transaction to be executed atomically?",
                                "options": {
                                                "A": "The transaction is split into multiple small parts",
                                                "B": "The transaction completes fully or not at all - there is no partial execution",
                                                "C": "The transaction uses atomic energy for processing",
                                                "D": "The transaction can be reversed at any time"
                                },
                                "correct": "B",
                                "explanation": "Atomic execution means a transaction either completes entirely or doesn't happen at all - there are no partial states. For example, when transferring $100, either the sender's balance decreases by $100 AND the recipient's balance increases by $100, or neither balance changes. There's no scenario where money disappears or gets duplicated. This 'all-or-nothing' property is critical for maintaining ledger integrity and preventing money creation or destruction.",
                                "difficulty": "hard"
                },
                {
                                "id": 16,
                                "question": "What is meant by a 'single source of truth' in banking systems?",
                                "options": {
                                                "A": "Banks must tell customers the truth about fees",
                                                "B": "Only one bank can operate in each country",
                                                "C": "The bank maintains the one authoritative ledger that all parties must accept as correct",
                                                "D": "All transactions must be verified by a single government agency"
                                },
                                "correct": "C",
                                "explanation": "The 'single source of truth' means there is one authoritative ledger that everyone must accept as correct - the bank's ledger. Whatever the bank records is the definitive state of all balances and transactions. This centralization solves double-spending because there's no ambiguity about account states, but it also means the bank has complete control. In blockchain systems, this concept is replaced with distributed consensus where many parties maintain identical copies of the ledger.",
                                "difficulty": "hard"
                },
                {
                                "id": 17,
                                "question": "The Byzantine Generals Problem, mentioned in the notebook, is fundamentally about:",
                                "options": {
                                                "A": "How military generals can communicate securely during war",
                                                "B": "How distributed parties can reach consensus when some participants might be unreliable or malicious",
                                                "C": "How to encrypt military communications",
                                                "D": "How to organize large armies efficiently"
                                },
                                "correct": "B",
                                "explanation": "The Byzantine Generals Problem is a famous thought experiment in distributed systems: how can multiple parties reach agreement when some might be faulty or malicious? The metaphor involves generals surrounding a city who must agree on whether to attack or retreat, but can only communicate via messengers, and some generals might be traitors. This problem is central to blockchain because it must solve coordination without a trusted central authority - nodes must reach consensus despite potentially having unreliable or malicious participants.",
                                "difficulty": "hard"
                },
                {
                                "id": 18,
                                "question": "What is the fundamental promise of blockchain compared to traditional finance?",
                                "options": {
                                                "A": "Blockchain guarantees profits on all investments",
                                                "B": "Blockchain makes all transactions completely anonymous",
                                                "C": "Blockchain solves double-spending using cryptographic proof and distributed consensus rather than trusting a central authority",
                                                "D": "Blockchain eliminates all transaction fees permanently"
                                },
                                "correct": "C",
                                "explanation": "Blockchain's fundamental promise is solving the double-spending problem WITHOUT requiring a trusted central intermediary. Instead of trusting a bank, you trust mathematics (cryptographic proof) and distributed consensus (many independent parties agreeing on the ledger state). This promises to reduce costs, eliminate single points of failure, prevent censorship, and enable permissionless access. However, blockchain is NOT a magic solution - it introduces different trade-offs and doesn't eliminate all fees or make transactions completely anonymous.",
                                "difficulty": "hard"
                },
                {
                                "id": 19,
                                "question": "According to the comparison table in the notebook, which statement best describes the trade-offs between cash, bank transfers, and cryptocurrency?",
                                "options": {
                                                "A": "Cash is perfect for all transactions and has no limitations",
                                                "B": "Bank transfers are fast and cheap but lack privacy",
                                                "C": "Each system has different strengths: cash is fast and private but doesn't scale; banks are scalable but slow and exclusive; crypto aims to balance security, speed, and accessibility but with different trade-offs",
                                                "D": "Cryptocurrency is superior to cash and banks in every measurable way"
                                },
                                "correct": "C",
                                "explanation": "The notebook's comparison shows that no money system is perfect - each optimizes different characteristics. Cash scores high on speed and privacy but low on scalability and security (can be stolen/lost). Bank transfers score high on scalability and security but low on speed, cost, and privacy. Cryptocurrencies like Bitcoin and stablecoins aim for different optimization points - high security and censorship resistance but with varying speed and cost trade-offs. The key insight is that blockchain represents a different set of compromises, not a universal improvement.",
                                "difficulty": "hard"
                },
                {
                                "id": 20,
                                "question": "Why was blockchain technology fundamentally created? What problem does it solve?",
                                "options": {
                                                "A": "To make people rich through cryptocurrency speculation",
                                                "B": "To enable digital money without requiring a trusted central authority to prevent double-spending",
                                                "C": "To replace all government currencies with a single world currency",
                                                "D": "To make all financial transactions completely free of charge"
                                },
                                "correct": "B",
                                "explanation": "Blockchain was created to solve the double-spending problem in a decentralized way. Satoshi Nakamoto's Bitcoin whitepaper presented the first practical solution that allows digital money to work without trusting a bank or central authority. By combining cryptographic proof, distributed ledgers, and consensus mechanisms, blockchain enables participants to agree on transaction validity without needing an intermediary. The goal is 'trustless' transactions where you trust the mathematics and the protocol rather than an institution - addressing the costs of centralized trust: fees, delays, censorship risk, counterparty risk, and exclusion.",
                                "difficulty": "hard"
                }
]
        };

        const state = {
            currentIndex: 0,
            answers: {},
            score: 0,
            displayedQuestions: [],
            pendingSlots: []
        };

        const questionsRow = document.getElementById('questionsRow');
        const progressBar = document.getElementById('progressBar');
        const progressBadge = document.getElementById('progressBadge');
        const scoreBadge = document.getElementById('scoreBadge');
        const resultsCard = document.getElementById('resultsCard');
        const nextBtn = document.getElementById('nextBtn');

        function initQuiz() {
            state.currentIndex = 0;
            state.answers = {};
            state.score = 0;
            state.displayedQuestions = [];
            state.pendingSlots = [];

            resultsCard.classList.remove('show');
            questionsRow.style.display = 'grid';
            nextBtn.classList.remove('show');

            // Show first 3 questions
            for (let i = 0; i < 3 && i < quizData.questions.length; i++) {
                state.displayedQuestions.push(i);
            }
            state.currentIndex = Math.min(3, quizData.questions.length);

            renderQuestions();
            updateStats();
        }

        function renderQuestions() {
            questionsRow.innerHTML = '';

            state.displayedQuestions.forEach((qIdx, slot) => {
                const q = quizData.questions[qIdx];
                const answered = state.answers[q.id] !== undefined;
                const isCorrect = answered && state.answers[q.id] === q.correct;
                const isIncorrect = answered && state.answers[q.id] !== q.correct;

                const card = document.createElement('div');
                card.className = 'question-card';
                if (isCorrect) card.classList.add('correct-card', 'answered');
                if (isIncorrect) card.classList.add('incorrect-card', 'answered');

                card.innerHTML = `
                    <div class="q-header">
                        <span class="q-number">Q${qIdx + 1}</span>
                        ${answered ? `<span class="q-status">${isCorrect ? '&#10004;' : '&#10008;'}</span>` : ''}
                    </div>
                    <div class="q-text">${q.question}</div>
                    <div class="options" data-qid="${q.id}" data-slot="${slot}">
                        ${['A','B','C','D'].map(letter => {
                            let optClass = 'option-btn';
                            if (answered) {
                                optClass += ' disabled';
                                if (letter === q.correct) optClass += ' correct';
                                else if (letter === state.answers[q.id]) optClass += ' incorrect';
                            }
                            return `
                                <button class="${optClass}" data-letter="${letter}" ${answered ? 'disabled' : ''}>
                                    <span class="option-letter">${letter}</span>
                                    <span class="option-text">${q.options[letter]}</span>
                                </button>
                            `;
                        }).join('')}
                    </div>
                    <div class="feedback ${answered ? 'show' : ''} ${isCorrect ? 'correct' : 'incorrect'}">
                        ${answered ? (isCorrect ? '&#10004; ' : `&#10008; Answer: ${q.correct}. `) + q.explanation : ''}
                    </div>
                `;

                // Add click handlers
                if (!answered) {
                    card.querySelectorAll('.option-btn').forEach(btn => {
                        btn.addEventListener('click', () => handleAnswer(qIdx, slot, btn.dataset.letter));
                    });
                }

                questionsRow.appendChild(card);
            });

            renderMath();
        }

        function handleAnswer(qIdx, slot, letter) {
            const q = quizData.questions[qIdx];
            state.answers[q.id] = letter;

            if (letter === q.correct) state.score++;

            // Track this slot as pending replacement
            if (!state.pendingSlots.includes(slot)) {
                state.pendingSlots.push(slot);
            }

            updateStats();
            renderQuestions();

            // Check if all questions answered
            const answered = Object.keys(state.answers).length;
            if (answered >= quizData.questions.length) {
                // Short delay then show results
                setTimeout(showResults, 800);
            } else if (state.currentIndex < quizData.questions.length && state.pendingSlots.length > 0) {
                // Show Next button if there are more questions and pending slots
                nextBtn.classList.add('show');
            }
        }

        function loadNextQuestions() {
            // Replace pending slots with new questions
            while (state.pendingSlots.length > 0 && state.currentIndex < quizData.questions.length) {
                const slot = state.pendingSlots.shift();
                state.displayedQuestions[slot] = state.currentIndex;
                state.currentIndex++;
            }

            // Hide Next button
            nextBtn.classList.remove('show');

            renderQuestions();

            // Check if quiz is complete (all displayed questions answered)
            const answered = Object.keys(state.answers).length;
            if (answered >= quizData.questions.length) {
                setTimeout(showResults, 500);
            }
        }

        function updateStats() {
            const answered = Object.keys(state.answers).length;
            const total = quizData.questions.length;

            progressBar.style.width = `${(answered / total) * 100}%`;
            progressBadge.textContent = `${answered}/${total}`;
            scoreBadge.textContent = `Score: ${state.score}`;
        }

        function showResults() {
            questionsRow.style.display = 'none';
            nextBtn.classList.remove('show');
            resultsCard.classList.add('show');

            const total = quizData.questions.length;
            const percentage = Math.round((state.score / total) * 100);

            document.getElementById('resultsScore').textContent = `${state.score}/${total}`;

            let grade, gradeClass, icon;
            if (percentage >= 90) { grade = 'Excellent! A'; gradeClass = 'grade-a'; icon = '&#127942;'; }
            else if (percentage >= 80) { grade = 'Great! B'; gradeClass = 'grade-b'; icon = '&#11088;'; }
            else if (percentage >= 70) { grade = 'Good! C'; gradeClass = 'grade-c'; icon = '&#128077;'; }
            else if (percentage >= 60) { grade = 'Pass - D'; gradeClass = 'grade-d'; icon = '&#128221;'; }
            else { grade = 'Keep practicing'; gradeClass = 'grade-f'; icon = '&#128218;'; }

            document.getElementById('resultsIcon').innerHTML = icon;
            const gradeEl = document.getElementById('resultsGrade');
            gradeEl.textContent = `${grade} (${percentage}%)`;
            gradeEl.className = `results-grade ${gradeClass}`;
        }

        function restartQuiz() {
            initQuiz();
        }

        function renderMath() {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false}
                    ],
                    throwOnError: false
                });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initQuiz();
            setTimeout(renderMath, 100);
        });
    </script>
</body>
</html>
