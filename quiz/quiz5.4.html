<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 5.4: Privacy Inclusion | Introduction to Digital Finance</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --mlpurple: #3333B2;
            --mlblue: #0066CC;
            --quiz-accent: #8b5cf6;
            --quiz-light: #ede9fe;
            --correct: #22c55e;
            --correct-bg: #dcfce7;
            --incorrect: #ef4444;
            --incorrect-bg: #fee2e2;
            --bg: #f6f8fa;
            --card-bg: #ffffff;
            --text: #24292e;
            --text-secondary: #586069;
            --border: #e1e4e8;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.4;
            min-height: 100vh;
        }

        .nav {
            background: linear-gradient(135deg, var(--mlpurple), var(--mlblue));
            color: white;
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .nav-title { font-weight: 600; font-size: 14px; }
        .nav-links { display: flex; gap: 16px; }
        .nav-links a { color: white; text-decoration: none; font-size: 12px; opacity: 0.9; }
        .nav-links a:hover { opacity: 1; }

        .quiz-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 12px;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 0 4px;
        }
        .quiz-title { font-size: 16px; font-weight: 600; color: var(--mlpurple); }
        .quiz-stats {
            display: flex;
            gap: 12px;
            font-size: 12px;
        }
        .stat-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
        }
        .stat-progress { background: var(--quiz-light); color: var(--quiz-accent); }
        .stat-score { background: var(--correct-bg); color: var(--correct); }

        .progress-bar-container {
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin-bottom: 12px;
        }
        .progress-bar {
            height: 100%;
            background: var(--quiz-accent);
            border-radius: 2px;
            transition: width 0.3s;
        }

        /* Three-column layout */
        .questions-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .question-card {
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 12px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            min-height: 280px;
        }

        .question-card.answered { opacity: 0.7; }

        .question-card.correct-card {
            border: 2px solid var(--correct);
            background: linear-gradient(to bottom, var(--correct-bg), var(--card-bg));
        }

        .question-card.incorrect-card {
            border: 2px solid var(--incorrect);
            background: linear-gradient(to bottom, var(--incorrect-bg), var(--card-bg));
        }

        .q-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .q-number {
            background: var(--quiz-light);
            color: var(--quiz-accent);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        .q-status { font-size: 14px; }

        .q-text {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 10px;
            line-height: 1.4;
            flex-grow: 0;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex-grow: 1;
        }

        .option-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            min-height: 44px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--card-bg);
            cursor: pointer;
            transition: all 0.15s;
            text-align: left;
            font-size: 12px;
        }

        .option-btn:hover:not(.disabled) {
            border-color: var(--quiz-accent);
            background: var(--quiz-light);
        }

        .option-btn.correct {
            border-color: var(--correct);
            background: var(--correct-bg);
        }

        .option-btn.incorrect {
            border-color: var(--incorrect);
            background: var(--incorrect-bg);
        }

        .option-btn.disabled { cursor: default; }

        .option-letter {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 10px;
            flex-shrink: 0;
        }

        .option-btn.correct .option-letter {
            background: var(--correct);
            color: white;
        }

        .option-btn.incorrect .option-letter {
            background: var(--incorrect);
            color: white;
        }

        .option-text { flex: 1; }

        .feedback {
            margin-top: 8px;
            padding: 8px;
            border-radius: 6px;
            font-size: 10px;
            line-height: 1.4;
            display: none;
        }

        .feedback.show { display: block; }
        .feedback.correct { background: var(--correct-bg); color: #166534; }
        .feedback.incorrect { background: var(--incorrect-bg); color: #991b1b; }

        /* Results */
        .results-card {
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 32px;
            text-align: center;
            max-width: 500px;
            margin: 40px auto;
            display: none;
        }
        .results-card.show { display: block; }
        .results-icon { font-size: 48px; margin-bottom: 8px; }
        .results-score { font-size: 36px; font-weight: 700; color: var(--quiz-accent); }
        .results-label { font-size: 14px; color: var(--text-secondary); margin-bottom: 16px; }
        .results-grade {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .grade-a { background: #dcfce7; color: #166534; }
        .grade-b { background: #dbeafe; color: #1e40af; }
        .grade-c { background: #fef3c7; color: #92400e; }
        .grade-d { background: #fed7aa; color: #9a3412; }
        .grade-f { background: #fee2e2; color: #991b1b; }

        .results-buttons { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            text-decoration: none;
        }
        .btn-primary { background: var(--quiz-accent); color: white; }
        .btn-primary:hover { background: #7c3aed; }
        .btn-secondary { background: var(--card-bg); color: var(--text); border: 1px solid var(--border); }

        /* Next button container */
        .next-btn-container {
            display: flex;
            justify-content: center;
            margin-top: 16px;
        }
        .btn-next {
            padding: 10px 32px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            background: var(--quiz-accent);
            color: white;
            transition: all 0.2s;
            display: none;
        }
        .btn-next:hover { background: #7c3aed; transform: scale(1.02); }
        .btn-next.show { display: inline-block; }
        .btn-next:disabled { opacity: 0.5; cursor: not-allowed; }

        @media (max-width: 900px) {
            .questions-row { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 600px) {
            .questions-row { grid-template-columns: 1fr; }
            .question-card { min-height: auto; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-title">Quiz 5.4: Privacy Inclusion</div>
        <div class="nav-links">
            <a href="../index.html">Dashboard</a>
            
            <a href="https://github.com/Digital-AI-Finance/Digital-Finance-Introduction" target="_blank">GitHub</a>
        </div>
    </nav>

    <main class="quiz-container">
        <div class="quiz-header">
            <div class="quiz-title">Quiz 5.4: Privacy Inclusion</div>
            <div class="quiz-stats">
                <span class="stat-badge stat-progress" id="progressBadge">0/20</span>
                <span class="stat-badge stat-score" id="scoreBadge">Score: 0</span>
            </div>
        </div>

        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>

        <div class="questions-row" id="questionsRow"></div>

        <div class="next-btn-container">
            <button class="btn-next" id="nextBtn" onclick="loadNextQuestions()">Next</button>
        </div>

        <div class="results-card" id="resultsCard">
            <div class="results-icon" id="resultsIcon"></div>
            <div class="results-score" id="resultsScore"></div>
            <div class="results-label">Correct Answers</div>
            <div class="results-grade" id="resultsGrade"></div>
            <div class="results-buttons">
                <button class="btn btn-primary" onclick="restartQuiz()">Try Again</button>
                <a href="../index.html" class="btn btn-secondary">Dashboard</a>
            </div>
        </div>
    </main>

    <script>
        const quizData = {
            questions: [
                {
                                "id": 1,
                                "question": "What does 'financial inclusion' primarily refer to?",
                                "options": {
                                                "A": "Including crypto assets in traditional portfolios",
                                                "B": "Providing access to useful and affordable financial services to underserved populations",
                                                "C": "Requiring all citizens to have bank accounts",
                                                "D": "Integrating blockchain technology into existing financial systems"
                                },
                                "correct": "B",
                                "explanation": "Financial inclusion refers to ensuring that individuals and businesses have access to useful and affordable financial products and services (transactions, payments, savings, credit, insurance) that meet their needs and are delivered in a responsible and sustainable way. The goal is to bring the unbanked and underbanked into the formal financial system.",
                                "difficulty": "easy"
                },
                {
                                "id": 2,
                                "question": "Approximately how many adults globally remain unbanked according to current estimates?",
                                "options": {
                                                "A": "400 million",
                                                "B": "800 million",
                                                "C": "1.4 billion",
                                                "D": "2.8 billion"
                                },
                                "correct": "C",
                                "explanation": "Approximately 1.4 billion adults globally remain unbanked, meaning they lack access to formal financial services. This represents a significant portion of the world's population who cannot easily save, borrow, or make secure transactions through traditional banking channels. This gap represents both a social challenge and an opportunity for digital finance innovations.",
                                "difficulty": "easy"
                },
                {
                                "id": 3,
                                "question": "What are common barriers to financial access for unbanked populations?",
                                "options": {
                                                "A": "Lack of interest in financial services",
                                                "B": "Geographic distance to banks, high fees, documentation requirements, and lack of credit history",
                                                "C": "Government restrictions on all forms of money",
                                                "D": "Absence of currency in developing regions"
                                },
                                "correct": "B",
                                "explanation": "Barriers to financial access include: physical distance to bank branches (especially in rural areas), high minimum balance requirements and transaction fees, strict documentation requirements (ID, proof of address), lack of credit history for loans, distrust of institutions, and language barriers. These factors disproportionately affect low-income, rural, and marginalized populations.",
                                "difficulty": "easy"
                },
                {
                                "id": 4,
                                "question": "What made M-Pesa a successful mobile money platform in Kenya?",
                                "options": {
                                                "A": "It required smartphones and high-speed internet",
                                                "B": "It worked on basic mobile phones via SMS, enabling peer-to-peer transfers without bank accounts",
                                                "C": "It offered cryptocurrency trading to rural populations",
                                                "D": "It replaced the national currency with digital tokens"
                                },
                                "correct": "B",
                                "explanation": "M-Pesa's success stemmed from its simplicity and accessibility: it worked on basic feature phones via SMS (no smartphone needed), enabled peer-to-peer money transfers and bill payments without requiring bank accounts, and built on Kenya's already high mobile phone penetration. By 2024, M-Pesa has over 50 million users and processes billions in transactions, demonstrating that appropriate technology can drive financial inclusion.",
                                "difficulty": "medium"
                },
                {
                                "id": 5,
                                "question": "What is the fundamental tradeoff in the privacy-transparency spectrum for financial systems?",
                                "options": {
                                                "A": "Speed versus security",
                                                "B": "Individual privacy rights versus regulatory oversight and crime prevention",
                                                "C": "Centralization versus decentralization",
                                                "D": "Digital versus physical currency"
                                },
                                "correct": "B",
                                "explanation": "The privacy-transparency tradeoff pits individual privacy rights (protecting personal financial data, freedom from surveillance, fungibility of money) against regulatory needs (anti-money laundering, tax compliance, crime prevention, sanctions enforcement). This tension is central to debates about financial surveillance, CBDCs, privacy coins, and the appropriate level of transparency in digital finance.",
                                "difficulty": "medium"
                },
                {
                                "id": 6,
                                "question": "What is a zero-knowledge proof in the context of financial privacy?",
                                "options": {
                                                "A": "A proof that requires no computational resources to verify",
                                                "B": "A method to prove a statement is true without revealing any information beyond the truth of that statement",
                                                "C": "A system that requires zero trust between parties",
                                                "D": "A blockchain consensus mechanism with no validators"
                                },
                                "correct": "B",
                                "explanation": "A zero-knowledge proof (ZKP) is a cryptographic method where one party (the prover) can prove to another party (the verifier) that a statement is true without revealing any information beyond the truth of the statement itself. For example, proving you're over 18 without revealing your exact age, or proving you have sufficient funds without revealing your balance. ZKPs enable privacy-preserving compliance.",
                                "difficulty": "medium"
                },
                {
                                "id": 7,
                                "question": "What privacy technology does Monero (XMR) use to hide transaction details?",
                                "options": {
                                                "A": "Bitcoin's transparent blockchain with added encryption",
                                                "B": "Ring signatures and stealth addresses to obscure sender, receiver, and amount",
                                                "C": "Simple password protection on all transactions",
                                                "D": "Centralized servers that delete transaction logs"
                                },
                                "correct": "B",
                                "explanation": "Monero uses multiple privacy technologies: ring signatures (mix your transaction with others so the actual sender is hidden among decoys), stealth addresses (one-time addresses for each transaction so receivers can't be linked), and Ring Confidential Transactions (RingCT) to hide transaction amounts. This makes Monero transactions effectively untraceable and unlinkable, providing strong privacy but raising regulatory concerns.",
                                "difficulty": "hard"
                },
                {
                                "id": 8,
                                "question": "What privacy technique does Zcash use for shielded transactions?",
                                "options": {
                                                "A": "Ring signatures",
                                                "B": "CoinJoin mixing",
                                                "C": "zk-SNARKs (zero-knowledge succinct non-interactive arguments of knowledge)",
                                                "D": "Homomorphic encryption"
                                },
                                "correct": "C",
                                "explanation": "Zcash uses zk-SNARKs (zero-knowledge Succinct Non-interactive Arguments of Knowledge) to enable 'shielded' transactions where sender, receiver, and amount are encrypted and proven valid without revealing the details. Users can choose between transparent transactions (like Bitcoin) or shielded transactions (private). zk-SNARKs are computationally intensive but provide cryptographic guarantees of privacy while maintaining blockchain validity.",
                                "difficulty": "hard"
                },
                {
                                "id": 9,
                                "question": "What is the purpose of cryptocurrency mixer/tumbler services like Tornado Cash?",
                                "options": {
                                                "A": "To increase transaction speed on blockchains",
                                                "B": "To pool funds from multiple users and redistribute them to break the on-chain link between sender and receiver",
                                                "C": "To convert between different cryptocurrencies automatically",
                                                "D": "To provide liquidity for decentralized exchanges"
                                },
                                "correct": "B",
                                "explanation": "Mixers or tumblers like Tornado Cash pool deposits from many users into a smart contract, then allow withdrawals to different addresses, breaking the on-chain connection between depositor and recipient. Users prove they made a valid deposit using zero-knowledge proofs without revealing which deposit was theirs. This provides privacy for Ethereum transactions but has been controversial, leading to US sanctions on Tornado Cash in 2022.",
                                "difficulty": "medium"
                },
                {
                                "id": 10,
                                "question": "What guidance has the Financial Action Task Force (FATF) provided regarding privacy in crypto?",
                                "options": {
                                                "A": "Complete anonymity should be permitted for all transactions",
                                                "B": "Virtual Asset Service Providers must implement the 'Travel Rule' to share customer information for transactions above thresholds",
                                                "C": "Privacy coins should be the global standard for digital currency",
                                                "D": "No regulation is needed for cryptocurrency privacy"
                                },
                                "correct": "B",
                                "explanation": "FATF, the global anti-money laundering standard setter, requires Virtual Asset Service Providers (VASPs like exchanges) to implement the 'Travel Rule': sharing originator and beneficiary information for transfers above certain thresholds (often $1,000). This extends traditional banking AML/KYC requirements to crypto, aiming to prevent money laundering and terrorist financing while creating significant compliance challenges.",
                                "difficulty": "medium"
                },
                {
                                "id": 11,
                                "question": "What tools enable blockchain surveillance and transaction tracking?",
                                "options": {
                                                "A": "Only government intelligence agencies can track blockchain transactions",
                                                "B": "Blockchain analysis tools like Chainalysis, Elliptic, and TRM Labs that map transaction patterns and identify clusters",
                                                "C": "Blockchain transactions are completely untraceable by design",
                                                "D": "Only cryptocurrency creators can see transaction details"
                                },
                                "correct": "B",
                                "explanation": "Companies like Chainalysis, Elliptic, and TRM Labs provide blockchain analysis tools that map transaction flows, identify wallet clusters, link addresses to real-world identities (through exchange KYC, IP addresses, etc.), and flag suspicious activity. Law enforcement, exchanges, and financial institutions use these tools. While Bitcoin is pseudonymous, sophisticated analysis can often de-anonymize users through transaction graph analysis.",
                                "difficulty": "medium"
                },
                {
                                "id": 12,
                                "question": "What is transaction graph analysis in blockchain surveillance?",
                                "options": {
                                                "A": "Visualizing transaction fees over time",
                                                "B": "Tracking the flow of funds between addresses to identify patterns and link wallets to entities",
                                                "C": "Analyzing the graphical user interfaces of crypto wallets",
                                                "D": "Creating organizational charts of blockchain companies"
                                },
                                "correct": "B",
                                "explanation": "Transaction graph analysis examines the connections between blockchain addresses by tracing fund flows, identifying patterns (timing, amounts, behaviors), clustering addresses likely controlled by the same entity, and linking addresses to known identities (through exchange deposits, IP addresses, etc.). This reveals that blockchain pseudonymity often provides less privacy than users assume.",
                                "difficulty": "hard"
                },
                {
                                "id": 13,
                                "question": "What is the difference between pseudonymity and anonymity in blockchain contexts?",
                                "options": {
                                                "A": "Pseudonymity uses fake names; anonymity uses real names encrypted",
                                                "B": "Pseudonymity means addresses aren't directly linked to real identities but can potentially be traced; anonymity means transactions cannot be linked to any identity",
                                                "C": "They are the same thing in blockchain systems",
                                                "D": "Pseudonymity is permanent while anonymity is temporary"
                                },
                                "correct": "B",
                                "explanation": "Pseudonymity (Bitcoin, Ethereum) means public addresses serve as pseudonyms not directly tied to real identities, but transaction history is visible and addresses can potentially be linked to real people through analysis. Anonymity (Monero, Zcash shielded) means transactions cannot be traced or linked to identities at all. Many users mistakenly believe Bitcoin provides anonymity when it only provides pseudonymity.",
                                "difficulty": "hard"
                },
                {
                                "id": 14,
                                "question": "What does privacy-preserving compliance aim to achieve?",
                                "options": {
                                                "A": "Eliminating all financial regulations to maximize privacy",
                                                "B": "Proving compliance with regulations (like sanctions screening) without revealing sensitive user data",
                                                "C": "Making all transactions completely public and transparent",
                                                "D": "Replacing regulators with smart contracts"
                                },
                                "correct": "B",
                                "explanation": "Privacy-preserving compliance uses technologies like zero-knowledge proofs to enable users to prove they meet regulatory requirements (e.g., not on a sanctions list, old enough to transact, have sufficient funds) without revealing unnecessary personal information. This represents a potential middle ground between full surveillance and complete anonymity, though implementation remains technically and politically challenging.",
                                "difficulty": "medium"
                },
                {
                                "id": 15,
                                "question": "How do data protection regulations like GDPR relate to blockchain?",
                                "options": {
                                                "A": "GDPR doesn't apply to blockchain technology",
                                                "B": "GDPR's 'right to be forgotten' conflicts with blockchain's immutability, creating legal tensions",
                                                "C": "Blockchain was designed specifically to comply with GDPR",
                                                "D": "GDPR requires all financial data to be stored on public blockchains"
                                },
                                "correct": "B",
                                "explanation": "The EU's General Data Protection Regulation (GDPR) grants individuals the 'right to erasure' (right to be forgotten) for their personal data. This conflicts with blockchain's core feature: immutability. Once data is written to a blockchain, it typically cannot be deleted. This creates legal challenges: storing personal data on-chain may violate GDPR, while storing only hashes or using off-chain storage introduces centralization risks.",
                                "difficulty": "hard"
                },
                {
                                "id": 16,
                                "question": "What is self-sovereign identity (SSI) in the context of digital finance?",
                                "options": {
                                                "A": "Government-issued digital IDs that track all citizen activities",
                                                "B": "An identity model where individuals control their own identity data without relying on centralized authorities",
                                                "C": "Corporate loyalty programs that track customer purchases",
                                                "D": "Biometric identification systems used by banks"
                                },
                                "correct": "B",
                                "explanation": "Self-sovereign identity gives individuals control over their own identity data rather than relying on governments, corporations, or other centralized authorities as identity providers. Users can selectively share verified credentials (age, citizenship, creditworthiness) without revealing underlying data, often using decentralized identifiers (DIDs) and verifiable credentials. SSI aims to enhance privacy and user autonomy while enabling verification.",
                                "difficulty": "medium"
                },
                {
                                "id": 17,
                                "question": "What capabilities do Central Bank Digital Currencies (CBDCs) potentially enable for governments?",
                                "options": {
                                                "A": "Only improved payment speed with no other changes",
                                                "B": "Complete transaction visibility, programmable spending restrictions, automatic tax collection, and expiring money",
                                                "C": "Elimination of all government monetary policy tools",
                                                "D": "Mandatory anonymous transactions for all citizens"
                                },
                                "correct": "B",
                                "explanation": "CBDCs give governments unprecedented capabilities: real-time visibility into all transactions, ability to program money for specific uses (e.g., only for food, not alcohol), geographic restrictions, automatic tax withholding, expiring money (demurrage to encourage spending), integration with social credit systems, and ability to freeze or confiscate funds remotely. China's e-CNY demonstrates many of these capabilities, raising surveillance concerns.",
                                "difficulty": "easy"
                },
                {
                                "id": 18,
                                "question": "How can DeFi potentially contribute to financial inclusion?",
                                "options": {
                                                "A": "By requiring expensive computer equipment for all users",
                                                "B": "Through permissionless access, reduced costs, global reach, and programmable financial services without traditional gatekeepers",
                                                "C": "By eliminating all financial services for underserved populations",
                                                "D": "By restricting access to only wealthy investors"
                                },
                                "correct": "B",
                                "explanation": "DeFi's potential for inclusion includes: permissionless access (no bank account or credit history required), reduced costs (no bank branch infrastructure), global reach (cross-border without intermediaries), composable services (access to lending, savings, insurance), and programmability (micro-transactions, automated services). However, barriers remain: internet access, technical literacy, device costs, gas fees, and regulatory uncertainty.",
                                "difficulty": "medium"
                },
                {
                                "id": 19,
                                "question": "How can cryptocurrency potentially reduce remittance costs?",
                                "options": {
                                                "A": "By eliminating all fees completely",
                                                "B": "Through peer-to-peer transfers using stablecoins, avoiding traditional correspondent banking networks and their fees",
                                                "C": "By increasing fees to improve service quality",
                                                "D": "Cryptocurrency cannot be used for remittances"
                                },
                                "correct": "B",
                                "explanation": "Traditional remittances through Western Union, MoneyGram, or banks often cost 5-10% due to correspondent banking networks, currency conversion fees, and intermediary costs. Cryptocurrency (especially stablecoins) enables direct peer-to-peer transfers or use of crypto rails (fiat→crypto→transfer→crypto→fiat) with potentially lower fees. This is particularly valuable for corridors where remittances represent significant GDP (like 20% for El Salvador).",
                                "difficulty": "medium"
                },
                {
                                "id": 20,
                                "question": "What are 'last-mile delivery challenges' in financial inclusion?",
                                "options": {
                                                "A": "Problems with shipping physical goods to customers",
                                                "B": "The difficulties in converting digital financial services into real-world utility for end users (cash-in/cash-out, merchant acceptance, user education)",
                                                "C": "Delivery of bank cards to rural areas",
                                                "D": "The final kilometer of fiber optic cable installation"
                                },
                                "correct": "B",
                                "explanation": "Last-mile delivery challenges refer to bridging the gap between digital financial infrastructure and actual usability: converting fiat to crypto and back (cash-in/cash-out points), merchant acceptance for daily purchases, user education and technical literacy, device access, internet connectivity, language barriers, and trust-building. Even with sophisticated DeFi protocols, these practical challenges often prevent real-world adoption by underserved populations.",
                                "difficulty": "hard"
                }
]
        };

        const state = {
            currentIndex: 0,
            answers: {},
            score: 0,
            displayedQuestions: [],
            pendingSlots: []
        };

        const questionsRow = document.getElementById('questionsRow');
        const progressBar = document.getElementById('progressBar');
        const progressBadge = document.getElementById('progressBadge');
        const scoreBadge = document.getElementById('scoreBadge');
        const resultsCard = document.getElementById('resultsCard');
        const nextBtn = document.getElementById('nextBtn');

        function initQuiz() {
            state.currentIndex = 0;
            state.answers = {};
            state.score = 0;
            state.displayedQuestions = [];
            state.pendingSlots = [];

            resultsCard.classList.remove('show');
            questionsRow.style.display = 'grid';
            nextBtn.classList.remove('show');

            // Show first 3 questions
            for (let i = 0; i < 3 && i < quizData.questions.length; i++) {
                state.displayedQuestions.push(i);
            }
            state.currentIndex = Math.min(3, quizData.questions.length);

            renderQuestions();
            updateStats();
        }

        function renderQuestions() {
            questionsRow.innerHTML = '';

            state.displayedQuestions.forEach((qIdx, slot) => {
                const q = quizData.questions[qIdx];
                const answered = state.answers[q.id] !== undefined;
                const isCorrect = answered && state.answers[q.id] === q.correct;
                const isIncorrect = answered && state.answers[q.id] !== q.correct;

                const card = document.createElement('div');
                card.className = 'question-card';
                if (isCorrect) card.classList.add('correct-card', 'answered');
                if (isIncorrect) card.classList.add('incorrect-card', 'answered');

                card.innerHTML = `
                    <div class="q-header">
                        <span class="q-number">Q${qIdx + 1}</span>
                        ${answered ? `<span class="q-status">${isCorrect ? '&#10004;' : '&#10008;'}</span>` : ''}
                    </div>
                    <div class="q-text">${q.question}</div>
                    <div class="options" data-qid="${q.id}" data-slot="${slot}">
                        ${['A','B','C','D'].map(letter => {
                            let optClass = 'option-btn';
                            if (answered) {
                                optClass += ' disabled';
                                if (letter === q.correct) optClass += ' correct';
                                else if (letter === state.answers[q.id]) optClass += ' incorrect';
                            }
                            return `
                                <button class="${optClass}" data-letter="${letter}" ${answered ? 'disabled' : ''}>
                                    <span class="option-letter">${letter}</span>
                                    <span class="option-text">${q.options[letter]}</span>
                                </button>
                            `;
                        }).join('')}
                    </div>
                    <div class="feedback ${answered ? 'show' : ''} ${isCorrect ? 'correct' : 'incorrect'}">
                        ${answered ? (isCorrect ? '&#10004; ' : `&#10008; Answer: ${q.correct}. `) + q.explanation : ''}
                    </div>
                `;

                // Add click handlers
                if (!answered) {
                    card.querySelectorAll('.option-btn').forEach(btn => {
                        btn.addEventListener('click', () => handleAnswer(qIdx, slot, btn.dataset.letter));
                    });
                }

                questionsRow.appendChild(card);
            });

            renderMath();
        }

        function handleAnswer(qIdx, slot, letter) {
            const q = quizData.questions[qIdx];
            state.answers[q.id] = letter;

            if (letter === q.correct) state.score++;

            // Track this slot as pending replacement
            if (!state.pendingSlots.includes(slot)) {
                state.pendingSlots.push(slot);
            }

            updateStats();
            renderQuestions();

            // Check if all questions answered
            const answered = Object.keys(state.answers).length;
            if (answered >= quizData.questions.length) {
                // Short delay then show results
                setTimeout(showResults, 800);
            } else if (state.currentIndex < quizData.questions.length && state.pendingSlots.length > 0) {
                // Show Next button if there are more questions and pending slots
                nextBtn.classList.add('show');
            }
        }

        function loadNextQuestions() {
            // Replace pending slots with new questions
            while (state.pendingSlots.length > 0 && state.currentIndex < quizData.questions.length) {
                const slot = state.pendingSlots.shift();
                state.displayedQuestions[slot] = state.currentIndex;
                state.currentIndex++;
            }

            // Hide Next button
            nextBtn.classList.remove('show');

            renderQuestions();

            // Check if quiz is complete (all displayed questions answered)
            const answered = Object.keys(state.answers).length;
            if (answered >= quizData.questions.length) {
                setTimeout(showResults, 500);
            }
        }

        function updateStats() {
            const answered = Object.keys(state.answers).length;
            const total = quizData.questions.length;

            progressBar.style.width = `${(answered / total) * 100}%`;
            progressBadge.textContent = `${answered}/${total}`;
            scoreBadge.textContent = `Score: ${state.score}`;
        }

        function showResults() {
            questionsRow.style.display = 'none';
            nextBtn.classList.remove('show');
            resultsCard.classList.add('show');

            const total = quizData.questions.length;
            const percentage = Math.round((state.score / total) * 100);

            document.getElementById('resultsScore').textContent = `${state.score}/${total}`;

            let grade, gradeClass, icon;
            if (percentage >= 90) { grade = 'Excellent! A'; gradeClass = 'grade-a'; icon = '&#127942;'; }
            else if (percentage >= 80) { grade = 'Great! B'; gradeClass = 'grade-b'; icon = '&#11088;'; }
            else if (percentage >= 70) { grade = 'Good! C'; gradeClass = 'grade-c'; icon = '&#128077;'; }
            else if (percentage >= 60) { grade = 'Pass - D'; gradeClass = 'grade-d'; icon = '&#128221;'; }
            else { grade = 'Keep practicing'; gradeClass = 'grade-f'; icon = '&#128218;'; }

            document.getElementById('resultsIcon').innerHTML = icon;
            const gradeEl = document.getElementById('resultsGrade');
            gradeEl.textContent = `${grade} (${percentage}%)`;
            gradeEl.className = `results-grade ${gradeClass}`;
        }

        function restartQuiz() {
            initQuiz();
        }

        function renderMath() {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false}
                    ],
                    throwOnError: false
                });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initQuiz();
            setTimeout(renderMath, 100);
        });
    </script>
</body>
</html>
